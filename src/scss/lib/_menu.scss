/* MENU */

$caret-size: $font-size-base / 3;
$caret-color: $text-color-base;

/////////////////////////////////////////////////////////////////////////////
// COMMON STYLES

.menu-primary,
.menu-secondary {
  .menu-item {
    > .menu-item-link {
      // Debug
      // background: $gray-lighter;
      color: $gray-darker;
      transition: all 0.25s;

      &:hover,
      &:active,
      &:focus {
        color: $gray-darkest;
        background: $gray-lighter;
      }

      display: block;
      min-height: 4.4rem;
      padding-left: $gutter-half;
      padding-right: $gutter-half;
      cursor: pointer;

      // Flex vertical center
      display: flex;
      align-items: center;
      justify-content: space-between; // For carets on mobile

      // don't catch submenus carret span
      > span:not(.caret) {
        line-height: 1; // In case of multi-line
        padding: $gutter-quarter 0;
      }

      > .caret {
        display: block;
        width: 0;
        height: 0;
        border-style: solid;
        border-width: $caret-size $caret-size 0 $caret-size;
        border-color: $caret-color transparent transparent transparent;
        transition: all 0.5s $ease-bump;
      }
    }

    // Active item
    &.current-menu-item {
      > .menu-item-link {
        color: $color-secondary;
      }
    }

    > .dropdown-menu {
      // reset lists
      list-style-type: none;
      padding-left: 0;

      .menu-item {
        > .menu-item-link {
          @include bp($expanded, true) {
            padding-left: $gutter;
          }
        }
      }
    }

    &.active {
      > .menu-item-link {
        > .caret {
          transform: rotateZ(180deg);
        }
      }
    }
  }
}

/////////////////////////////////////////////////////////////////////////////
// MOBILE MENU

// Pain in the ass to reset mobile navbar styles on larger screens
// So for once, we allow MOBILE ONLY styles max-width @mq here!
@include bp($expanded, true) {
  //No secondary menu on mobile (hidden and merged into primary one)
  .menu-primary {
    padding-top: $gutter-half;
    padding-left: $gutter-quarter;
    padding-right: $gutter-quarter;

    .menu-item:not(.dropdown),
    .dropdown-toggle {
      // Space between items when stacked
      margin-bottom: $gutter-quarter;
    }
  }
  // Hide and show sub-menus
  .dropdown-menu {
    display: none;

    .dropdown.active & {
      display: block;
    }
  }
}

/////////////////////////////////////////////////////////////////////////////
//DESKTOP MENU

@include bp($expanded) {
  .menu-primary {
    margin-right: -$gutter-half;
    margin-left: $gutter-half;
  }

  .menu-secondary {
  }

  .menu-primary,
  .menu-secondary {
    .menu-item {
      margin-left: $gutter-quarter;
      > .menu-item-link {
        > .caret {
          margin-left: $gutter-quarter;
        }
      }
    }

    // Hide and show dropdown submenu
    .dropdown {
      position: relative;
      transition: all 0.25s ease;

      .dropdown-menu {
        background-color: $header-color-bg;
        position: absolute;
        left: 0;
        width: 20vw;
        padding-top: $gutter-quarter;

        display: flex;
        flex-direction: column;
        justify-content: center;
        box-shadow: none;
        @include shadow(1);
        transform: scale3d(1, 0, 1);
        transform-origin: 50% 0 0;
        transition: transform 0.5s $ease-bump;
        overflow: hidden;

        > .menu-item {
          margin: $gutter-quarter;
          margin-top: 0;
        }
      }
    }

    .dropdown.active {
      @include shadow(1);
      margin-bottom: 0;

      .dropdown-menu {
        transform: scale3d(1, 1, 1);
      }
    }
  }
}
